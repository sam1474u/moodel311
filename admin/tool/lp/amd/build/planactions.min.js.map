{"version":3,"file":"planactions.min.js","sources":["../src/planactions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Plan actions via ajax.\n *\n * @module     tool_lp/planactions\n * @copyright  2015 David Monllao\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'core/templates',\n        'core/ajax',\n        'core/notification',\n        'core/str',\n        'tool_lp/menubar',\n        'tool_lp/dialogue'],\n        function($, templates, ajax, notification, str, Menubar, Dialogue) {\n\n    /**\n     * PlanActions class.\n     *\n     * Note that presently this cannot be instantiated more than once per page.\n     *\n     * @param {String} type The type of page we're in.\n     */\n    var PlanActions = function(type) {\n        this._type = type;\n\n        if (type === 'plan') {\n            // This is the page to view one plan.\n            this._region = '[data-region=\"plan-page\"]';\n            this._planNode = '[data-region=\"plan-page\"]';\n            this._template = 'tool_lp/plan_page';\n            this._contextMethod = 'tool_lp_data_for_plan_page';\n\n        } else if (type === 'plans') {\n            // This is the page to view a list of plans.\n            this._region = '[data-region=\"plans\"]';\n            this._planNode = '[data-region=\"plan-node\"]';\n            this._template = 'tool_lp/plans_page';\n            this._contextMethod = 'tool_lp_data_for_plans_page';\n\n        } else {\n            throw new TypeError('Unexpected type.');\n        }\n    };\n\n    /** @property {String} Ajax method to fetch the page data from. */\n    PlanActions.prototype._contextMethod = null;\n    /** @property {String} Selector to find the node describing the plan. */\n    PlanActions.prototype._planNode = null;\n    /** @property {String} Selector mapping to the region to update. Usually similar to wrapper. */\n    PlanActions.prototype._region = null;\n    /** @property {String} Name of the template used to render the region. */\n    PlanActions.prototype._template = null;\n    /** @property {String} Type of page/region we're in. */\n    PlanActions.prototype._type = null;\n\n    /**\n     * Resolve the arguments to refresh the region.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @return {Object} List of arguments.\n     */\n    PlanActions.prototype._getContextArgs = function(planData) {\n        var self = this,\n            args = {};\n\n        if (self._type === 'plan') {\n            args = {\n                planid: planData.id\n            };\n\n        } else if (self._type === 'plans') {\n            args = {\n                userid: planData.userid\n            };\n        }\n\n        return args;\n    };\n\n    /**\n     * Refresh the plan view.\n     *\n     * This is useful when you only want to refresh the view.\n     *\n     * @param  {String} selector The node to search the plan data from.\n     */\n    PlanActions.prototype.refresh = function(selector) {\n        var planData = this._findPlanData($(selector));\n        this._callAndRefresh([], planData);\n    };\n\n    /**\n     * Callback to render the region template.\n     *\n     * @param {Object} context The context for the template.\n     * @return {Promise}\n     */\n    PlanActions.prototype._renderView = function(context) {\n        var self = this;\n        return templates.render(self._template, context)\n            .then(function(newhtml, newjs) {\n                $(self._region).replaceWith(newhtml);\n                templates.runTemplateJS(newjs);\n                return;\n            });\n    };\n\n    /**\n     * Call multiple ajax methods, and refresh.\n     *\n     * @param  {Array}  calls    List of Ajax calls.\n     * @param  {Object} planData Plan data from plan node.\n     * @return {Promise}\n     */\n    PlanActions.prototype._callAndRefresh = function(calls, planData) {\n        // Because this function causes a refresh, we must track the JS completion from start to finish to prevent\n        // stale reference issues in Behat.\n        var callKey = 'tool_lp/planactions:_callAndRefresh-' + Math.floor(Math.random() * Math.floor(1000));\n        M.util.js_pending(callKey);\n\n        var self = this;\n        calls.push({\n            methodname: self._contextMethod,\n            args: self._getContextArgs(planData)\n        });\n\n        // Apply all the promises, and refresh when the last one is resolved.\n        return $.when.apply($, ajax.call(calls))\n            .then(function() {\n                return self._renderView(arguments[arguments.length - 1]);\n            })\n            .fail(notification.exception)\n            .always(function() {\n                return M.util.js_complete(callKey);\n            });\n    };\n\n    /**\n     * Delete a plan and reload the region.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     */\n    PlanActions.prototype._doDelete = function(planData) {\n        var self = this,\n            calls = [{\n                methodname: 'core_competency_delete_plan',\n                args: {id: planData.id}\n            }];\n        self._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Delete a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     */\n    PlanActions.prototype.deletePlan = function(planData) {\n        var self = this,\n            requests;\n\n        requests = ajax.call([{\n            methodname: 'core_competency_read_plan',\n            args: {id: planData.id}\n        }]);\n\n        requests[0].done(function(plan) {\n            str.get_strings([\n                {key: 'confirm', component: 'moodle'},\n                {key: 'deleteplan', component: 'tool_lp', param: plan.name},\n                {key: 'delete', component: 'moodle'},\n                {key: 'cancel', component: 'moodle'}\n            ]).done(function(strings) {\n                notification.confirm(\n                    strings[0], // Confirm.\n                    strings[1], // Delete plan X?\n                    strings[2], // Delete.\n                    strings[3], // Cancel.\n                    function() {\n                        self._doDelete(planData);\n                    }\n                );\n            }).fail(notification.exception);\n        }).fail(notification.exception);\n\n    };\n\n    /**\n     * Reopen plan and reload the region.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     */\n    PlanActions.prototype._doReopenPlan = function(planData) {\n        var self = this,\n            calls = [{\n                methodname: 'core_competency_reopen_plan',\n                args: {planid: planData.id}\n            }];\n        self._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Reopen a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     */\n    PlanActions.prototype.reopenPlan = function(planData) {\n        var self = this,\n            requests = ajax.call([{\n                methodname: 'core_competency_read_plan',\n                args: {id: planData.id}\n            }]);\n\n        requests[0].done(function(plan) {\n            str.get_strings([\n                {key: 'confirm', component: 'moodle'},\n                {key: 'reopenplanconfirm', component: 'tool_lp', param: plan.name},\n                {key: 'reopenplan', component: 'tool_lp'},\n                {key: 'cancel', component: 'moodle'}\n            ]).done(function(strings) {\n                notification.confirm(\n                    strings[0], // Confirm.\n                    strings[1], // Reopen plan X?\n                    strings[2], // Reopen.\n                    strings[3], // Cancel.\n                    function() {\n                        self._doReopenPlan(planData);\n                    }\n                );\n            }).fail(notification.exception);\n        }).fail(notification.exception);\n\n    };\n\n    /**\n     * Complete plan and reload the region.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     */\n    PlanActions.prototype._doCompletePlan = function(planData) {\n        var self = this,\n            calls = [{\n                methodname: 'core_competency_complete_plan',\n                args: {planid: planData.id}\n            }];\n        self._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Complete a plan process.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     */\n    PlanActions.prototype.completePlan = function(planData) {\n        var self = this,\n            requests = ajax.call([{\n                methodname: 'core_competency_read_plan',\n                args: {id: planData.id}\n            }]);\n\n        requests[0].done(function(plan) {\n            str.get_strings([\n                {key: 'confirm', component: 'moodle'},\n                {key: 'completeplanconfirm', component: 'tool_lp', param: plan.name},\n                {key: 'completeplan', component: 'tool_lp'},\n                {key: 'cancel', component: 'moodle'}\n            ]).done(function(strings) {\n                notification.confirm(\n                    strings[0], // Confirm.\n                    strings[1], // Complete plan X?\n                    strings[2], // Complete.\n                    strings[3], // Cancel.\n                    function() {\n                        self._doCompletePlan(planData);\n                    }\n                );\n            }).fail(notification.exception);\n        }).fail(notification.exception);\n    };\n\n    /**\n     * Unlink plan and reload the region.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     */\n    PlanActions.prototype._doUnlinkPlan = function(planData) {\n        var self = this,\n            calls = [{\n                methodname: 'core_competency_unlink_plan_from_template',\n                args: {planid: planData.id}\n            }];\n        self._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Unlink a plan process.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     */\n    PlanActions.prototype.unlinkPlan = function(planData) {\n        var self = this,\n            requests = ajax.call([{\n                methodname: 'core_competency_read_plan',\n                args: {id: planData.id}\n            }]);\n\n        requests[0].done(function(plan) {\n            str.get_strings([\n                {key: 'confirm', component: 'moodle'},\n                {key: 'unlinkplantemplateconfirm', component: 'tool_lp', param: plan.name},\n                {key: 'unlinkplantemplate', component: 'tool_lp'},\n                {key: 'cancel', component: 'moodle'}\n            ]).done(function(strings) {\n                notification.confirm(\n                    strings[0], // Confirm.\n                    strings[1], // Unlink plan X?\n                    strings[2], // Unlink.\n                    strings[3], // Cancel.\n                    function() {\n                        self._doUnlinkPlan(planData);\n                    }\n                );\n            }).fail(notification.exception);\n        }).fail(notification.exception);\n    };\n\n    /**\n     * Request review of a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method _doRequestReview\n     */\n    PlanActions.prototype._doRequestReview = function(planData) {\n        var calls = [{\n            methodname: 'core_competency_plan_request_review',\n            args: {\n                id: planData.id\n            }\n        }];\n        this._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Request review of a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method requestReview\n     */\n    PlanActions.prototype.requestReview = function(planData) {\n        this._doRequestReview(planData);\n    };\n\n    /**\n     * Cancel review request of a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method _doCancelReviewRequest\n     */\n    PlanActions.prototype._doCancelReviewRequest = function(planData) {\n        var calls = [{\n            methodname: 'core_competency_plan_cancel_review_request',\n            args: {\n                id: planData.id\n            }\n        }];\n        this._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Cancel review request of a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method cancelReviewRequest\n     */\n    PlanActions.prototype.cancelReviewRequest = function(planData) {\n        this._doCancelReviewRequest(planData);\n    };\n\n    /**\n     * Start review of a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method _doStartReview\n     */\n    PlanActions.prototype._doStartReview = function(planData) {\n        var calls = [{\n            methodname: 'core_competency_plan_start_review',\n            args: {\n                id: planData.id\n            }\n        }];\n        this._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Start review of a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method startReview\n     */\n    PlanActions.prototype.startReview = function(planData) {\n        this._doStartReview(planData);\n    };\n\n    /**\n     * Stop review of a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method _doStopReview\n     */\n    PlanActions.prototype._doStopReview = function(planData) {\n        var calls = [{\n            methodname: 'core_competency_plan_stop_review',\n            args: {\n                id: planData.id\n            }\n        }];\n        this._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Stop review of a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method stopReview\n     */\n    PlanActions.prototype.stopReview = function(planData) {\n        this._doStopReview(planData);\n    };\n\n    /**\n     * Approve a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method _doApprove\n     */\n    PlanActions.prototype._doApprove = function(planData) {\n        var calls = [{\n            methodname: 'core_competency_approve_plan',\n            args: {\n                id: planData.id\n            }\n        }];\n        this._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Approve a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method approve\n     */\n    PlanActions.prototype.approve = function(planData) {\n        this._doApprove(planData);\n    };\n\n    /**\n     * Unapprove a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method _doUnapprove\n     */\n    PlanActions.prototype._doUnapprove = function(planData) {\n        var calls = [{\n            methodname: 'core_competency_unapprove_plan',\n            args: {\n                id: planData.id\n            }\n        }];\n        this._callAndRefresh(calls, planData);\n    };\n\n    /**\n     * Unapprove a plan.\n     *\n     * @param  {Object} planData Plan data from plan node.\n     * @method unapprove\n     */\n    PlanActions.prototype.unapprove = function(planData) {\n        this._doUnapprove(planData);\n    };\n\n    /**\n     * Display list of linked courses on a modal dialogue.\n     *\n     * @param  {Event} e The event.\n     */\n    PlanActions.prototype._showLinkedCoursesHandler = function(e) {\n        e.preventDefault();\n\n        var competencyid = $(e.target).data('id');\n        var requests = ajax.call([{\n            methodname: 'tool_lp_list_courses_using_competency',\n            args: {id: competencyid}\n        }]);\n\n        requests[0].done(function(courses) {\n            var context = {\n                courses: courses\n            };\n            templates.render('tool_lp/linked_courses_summary', context).done(function(html) {\n                str.get_string('linkedcourses', 'tool_lp').done(function(linkedcourses) {\n                    new Dialogue(\n                        linkedcourses, // Title.\n                        html // The linked courses.\n                    );\n                }).fail(notification.exception);\n            }).fail(notification.exception);\n        }).fail(notification.exception);\n    };\n\n    /**\n     * Plan event handler.\n     *\n     * @param  {String} method The method to call.\n     * @param  {Event} e The event.\n     * @method _eventHandler\n     */\n    PlanActions.prototype._eventHandler = function(method, e) {\n        e.preventDefault();\n        var data = this._findPlanData($(e.target));\n        this[method](data);\n    };\n\n    /**\n     * Find the plan data from the plan node.\n     *\n     * @param  {Node} node The node to search from.\n     * @return {Object} Plan data.\n     */\n    PlanActions.prototype._findPlanData = function(node) {\n        var parent = node.parentsUntil($(this._region).parent(), this._planNode),\n            data;\n\n        if (parent.length != 1) {\n            throw new Error('The plan node was not located.');\n        }\n\n        data = parent.data();\n        if (typeof data === 'undefined' || typeof data.id === 'undefined') {\n            throw new Error('Plan data could not be found.');\n        }\n\n        return data;\n    };\n\n    /**\n     * Enhance a menu bar.\n     *\n     * @param  {String} selector Menubar selector.\n     */\n    PlanActions.prototype.enhanceMenubar = function(selector) {\n        Menubar.enhance(selector, {\n            '[data-action=\"plan-delete\"]': this._eventHandler.bind(this, 'deletePlan'),\n            '[data-action=\"plan-complete\"]': this._eventHandler.bind(this, 'completePlan'),\n            '[data-action=\"plan-reopen\"]': this._eventHandler.bind(this, 'reopenPlan'),\n            '[data-action=\"plan-unlink\"]': this._eventHandler.bind(this, 'unlinkPlan'),\n            '[data-action=\"plan-request-review\"]': this._eventHandler.bind(this, 'requestReview'),\n            '[data-action=\"plan-cancel-review-request\"]': this._eventHandler.bind(this, 'cancelReviewRequest'),\n            '[data-action=\"plan-start-review\"]': this._eventHandler.bind(this, 'startReview'),\n            '[data-action=\"plan-stop-review\"]': this._eventHandler.bind(this, 'stopReview'),\n            '[data-action=\"plan-approve\"]': this._eventHandler.bind(this, 'approve'),\n            '[data-action=\"plan-unapprove\"]': this._eventHandler.bind(this, 'unapprove'),\n        });\n    };\n\n    /**\n     * Register the events in the region.\n     *\n     * At this stage this cannot be used with enhanceMenubar or multiple handlers\n     * will be added to the same node.\n     */\n    PlanActions.prototype.registerEvents = function() {\n        var wrapper = $(this._region);\n\n        wrapper.find('[data-action=\"plan-delete\"]').click(this._eventHandler.bind(this, 'deletePlan'));\n        wrapper.find('[data-action=\"plan-complete\"]').click(this._eventHandler.bind(this, 'completePlan'));\n        wrapper.find('[data-action=\"plan-reopen\"]').click(this._eventHandler.bind(this, 'reopenPlan'));\n        wrapper.find('[data-action=\"plan-unlink\"]').click(this._eventHandler.bind(this, 'unlinkPlan'));\n\n        wrapper.find('[data-action=\"plan-request-review\"]').click(this._eventHandler.bind(this, 'requestReview'));\n        wrapper.find('[data-action=\"plan-cancel-review-request\"]').click(this._eventHandler.bind(this, 'cancelReviewRequest'));\n        wrapper.find('[data-action=\"plan-start-review\"]').click(this._eventHandler.bind(this, 'startReview'));\n        wrapper.find('[data-action=\"plan-stop-review\"]').click(this._eventHandler.bind(this, 'stopReview'));\n        wrapper.find('[data-action=\"plan-approve\"]').click(this._eventHandler.bind(this, 'approve'));\n        wrapper.find('[data-action=\"plan-unapprove\"]').click(this._eventHandler.bind(this, 'unapprove'));\n\n        wrapper.find('[data-action=\"find-courses-link\"]').click(this._showLinkedCoursesHandler.bind(this));\n    };\n\n    return PlanActions;\n});\n"],"names":["define","$","templates","ajax","notification","str","Menubar","Dialogue","PlanActions","type","_type","_region","_planNode","_template","_contextMethod","TypeError","prototype","_getContextArgs","planData","self","args","this","planid","id","userid","refresh","selector","_findPlanData","_callAndRefresh","_renderView","context","render","then","newhtml","newjs","replaceWith","runTemplateJS","calls","callKey","Math","floor","random","M","util","js_pending","push","methodname","when","apply","call","arguments","length","fail","exception","always","js_complete","_doDelete","deletePlan","done","plan","get_strings","key","component","param","name","strings","confirm","_doReopenPlan","reopenPlan","_doCompletePlan","completePlan","_doUnlinkPlan","unlinkPlan","_doRequestReview","requestReview","_doCancelReviewRequest","cancelReviewRequest","_doStartReview","startReview","_doStopReview","stopReview","_doApprove","approve","_doUnapprove","unapprove","_showLinkedCoursesHandler","e","preventDefault","competencyid","target","data","courses","html","get_string","linkedcourses","_eventHandler","method","node","parent","parentsUntil","Error","enhanceMenubar","enhance","bind","registerEvents","wrapper","find","click"],"mappings":"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"}