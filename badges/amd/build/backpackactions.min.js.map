{"version":3,"file":"backpackactions.min.js","sources":["../src/backpackactions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Action methods related to backpacks.\n *\n * @module     core_badges/backpackactions\n * @copyright  2020 Sara Arjona <sara@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport selectors from 'core_badges/selectors';\nimport {get_string as getString} from 'core/str';\nimport Pending from 'core/pending';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport Config from 'core/config';\n\n/**\n * Set up the actions.\n *\n * @method init\n */\nexport const init = () => {\n    const pendingPromise = new Pending();\n\n    const root = $(selectors.elements.main);\n    registerListenerEvents(root);\n\n    pendingPromise.resolve();\n};\n\n/**\n * Register backpack related event listeners.\n *\n * @method registerListenerEvents\n * @param {Object} root The root element.\n */\nconst registerListenerEvents = (root) => {\n\n    root.on('click', selectors.actions.deletebackpack, async(e) => {\n        e.preventDefault();\n\n        const link = $(e.currentTarget);\n        const modal = await buildModal(link);\n\n        displayModal(modal, link);\n    });\n};\n\nconst buildModal = async(link) => {\n\n    const backpackurl = link.closest(selectors.elements.backpackurl).attr('data-backpackurl');\n\n    return ModalFactory.create({\n        title: await getString('delexternalbackpack', 'core_badges'),\n        body: await getString('delexternalbackpackconfirm', 'core_badges', backpackurl),\n        type: ModalFactory.types.SAVE_CANCEL,\n    });\n\n};\n\nconst displayModal = async(modal, link) => {\n    modal.setSaveButtonText(await getString('delete', 'core'));\n\n    modal.getRoot().on(ModalEvents.save, function() {\n        window.location.href = link.attr('href') + '&sesskey=' + Config.sesskey + '&confirm=1';\n    });\n\n    modal.getRoot().on(ModalEvents.hidden, function() {\n        modal.destroy();\n    });\n\n    modal.show();\n};\n"],"names":["_jquery","_interopRequireDefault","_selectors","_pending","_modal_factory","_modal_events","_config","pendingPromise","Pending","root","default","selectors","elements","main","registerListenerEvents","resolve","_ref2","_ref3","_ref","on","actions","deletebackpack","_asyncToGenerator","regeneratorRuntime","mark","e","link","modal","wrap","_context","prev","next","buildModal","preventDefault","currentTarget","sent","displayModal","stop","_callee","_x","apply","this","arguments","backpackurl","_context2","closest","attr","t0","ModalFactory","_str","get_string","t1","t2","types","SAVE_CANCEL","t4","title","body","type","t3","abrupt","create","call","_callee2","_x2","_callee3","_context3","setSaveButtonText","getRoot","ModalEvents","save","window","location","href","Config","sesskey","hidden","destroy","show","_x3","_x4"],"mappings":"48BAuBAA,QAAAC,uBAAAD,SACAE,WAAAD,uBAAAC,YAEAC,SAAAF,uBAAAE,UACAC,eAAAH,uBAAAG,gBACAC,cAAAJ,uBAAAI,eACAC,QAAAL,uBAAAK,uBAOoB,WAChB,IAAMC,eAAiB,IAAIC,SAAAA,QAErBC,MAAO,EAAAT,QAAAU,SAAEC,mBAAUC,SAASC,MAClCC,uBAAuBL,MAEvBF,eAAeQ,SAClB,EAQD,IAYgBC,MAYKC,MAxBfH,uBAAyB,SAACL,MAE5B,IAAAS,KAAAT,KAAKU,GAAG,QAASR,WAAAA,QAAUS,QAAQC,gBAAnCH,KAAAI,kBAAAC,mBAAAC,MAAmD,iBAAMC,GAAN,IAAAC,KAAAC,MAAA,OAAAJ,mBAAAK,MAAA,SAAAC,UAAA,OAAA,OAAAA,SAAAC,KAAAD,SAAAE,MAAA,KAAA,EAI3BC,OAHpBP,EAAEQ,iBAEIP,MAAO,EAAA1B,QAAAU,SAAEe,EAAES,eAH8BL,SAAAE,KAAA,EAI3BC,WAAWN,MAJgB,KAAA,EAIzCC,MAJyCE,SAAAM,KAM/CC,aAAaT,MAAOD,MAN2B,KAAA,EAAA,IAAA,MAAA,OAAAG,SAAAQ,OAAA,GAAAC,QAAnD,KAAA,SAAAC,IAAA,OAAArB,KAAAsB,MAAAC,KAAAC,UAAA,GAQH,EAEKV,YAAUhB,MAAAM,kBAAAC,mBAAAC,MAAG,kBAAME,MAAN,IAAAiB,YAAA,OAAApB,mBAAAK,MAAA,SAAAgB,WAAA,OAAA,OAAAA,UAAAd,KAAAc,UAAAb,MAAA,KAAA,EAAA,OAETY,YAAcjB,KAAKmB,QAAQlC,WAAAA,QAAUC,SAAS+B,aAAaG,KAAK,oBAFvDF,UAAAG,GAIRC,eAJQtC,QAAAkC,UAAAb,KAAA,GAKE,EAAUkB,KAAAC,YAAA,sBAAuB,eALnC,KAAA,EAAA,OAAAN,UAAAO,GAAAP,UAAAT,KAAAS,UAAAb,KAAA,GAMC,mBAAU,6BAA8B,cAAeY,aANxD,KAAA,EAAA,OAAAC,UAAAQ,GAAAR,UAAAT,KAOLa,UAAAA,GAAAA,eAAAA,QAAaK,MAAMC,YAPdV,UAAAW,GAAA,CAKXC,MALWZ,UAAAO,GAMXM,KANWb,UAAAQ,GAOXM,KAPWd,UAAAe,IAAAf,UAAAgB,OAAA,SAAAhB,UAAAG,GAIKc,OAJLC,KAAAlB,UAAAG,GAAAH,UAAAW,KAAA,KAAA,GAAA,IAAA,MAAA,OAAAX,UAAAP,OAAA,GAAA0B,SAAH,KAAA,SAAAC,KAAA,OAAAhD,MAAAwB,MAAAC,KAAAC,UAAA,GAYVN,cAAenB,MAAAK,kBAAAC,mBAAAC,MAAA,SAAAyC,SAAMtC,MAAOD,MAAb,OAAAH,mBAAAK,MAAA,SAAAsC,WAAA,OAAA,OAAAA,UAAApC,KAAAoC,UAAAnC,MAAA,KAAA,EAAA,OAAAmC,UAAAnB,GACjBpB,MADiBuC,UAAAnC,KAAA,GACa,EAAUkB,KAAAC,YAAA,SAAU,QADjC,KAAA,EAAAgB,UAAAf,GAAAe,UAAA/B,KAAA+B,UAAAnB,GACXoB,kBADWL,KAAAI,UAAAnB,GAAAmB,UAAAf,IAGjBxB,MAAMyC,UAAUjD,GAAGkD,cAAAA,QAAYC,MAAM,WACjCC,OAAOC,SAASC,KAAO/C,KAAKoB,KAAK,QAAU,YAAc4B,QAAOC,QAAAA,QAAU,YAC7E,IAEDhD,MAAMyC,UAAUjD,GAAGkD,cAAAA,QAAYO,QAAQ,WACnCjD,MAAMkD,SACT,IAEDlD,MAAMmD,OAXW,KAAA,EAAA,IAAA,MAAA,OAAAZ,UAAA7B,OAAA,GAAA4B,SAAH,KAAA,SAAAc,IAAAC,KAAA,OAAA/D,MAAAuB,MAAAC,KAAAC,UAAA"}